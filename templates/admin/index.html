{% extends "admin/layout.html" %}
{% block content %}

<h1 class="rpi-page-title">Administration</h1>
<h2 class="rpi-page-subtitle">Manage clients and users</h2>

<div class="clients">
    <table>
        <thead>
            <tr>
                <th></th>
                <th>ID</th>
                <th>Name</th>
                <th>Server</th>
                <th>Created At</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for client in clients %}
            <tr class="{% if not client['is_enabled'] %}client-disabled{% endif %}">
                <td title="{{ 'Public server' if client['is_public'] else 'Private server' }}">{{ '🔓' if client["is_public"] else '🔒' }}</td>
                <td>{{ client["client_id"] }}</td>
                <td>{{ client["name"] }}</td>
                <td><a href="https://discord.com/channels/{{ client['discord_server_id'] }}" target="_blank">Server Link</a></td>
                <td>{{ client["created_at"] }}</td>
                <td><a href="{{ url_for('admin_client', client_id=client['client_id']) }}" title="Edit {{ client['name'] }}">✏️</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="new-client">
        <form method="POST">
            <h2>Add New Client</h2>
        
            <div class="rpi-field">
                <label for="new-client-id" class="rpi-label">Client ID</label>
                <input id="new-client-id" name="client_id" type="text" class="rpi-input" placeholder="The ID that will be used in the URL" required>
            </div>

            <div class="rpi-field">
                <label for="new-client-name" class="rpi-label">Name</label>
                <input id="new-client-name" name="name" type="text" class="rpi-input" placeholder="Public-facing name of client" required>
            </div>

            <div class="rpi-field">
                <label for="new-client-welcome-message" class="rpi-label">Welcome Message</label>
                <input id="new-client-welcome-message" name="welcome_message" type="text" class="rpi-input" placeholder="Optional welcome message for users">
            </div>

            <div class="rpi-field">
                <label for="new-client-discord-server-id" class="rpi-label">Discord Server ID</label>
                <input id="new-client-discord-server-id" name="discord_server_id" type="text" class="rpi-input" placeholder="ID of Discord server" required>
            </div>

            <div class="rpi-field">
                <label for="new-client-discord-server-rpi-role-id" class="rpi-label">Discord Server RPI Role ID</label>
                <input id="new-client-discord-server-rpi-role-id" name="discord_rpi_role_id" type="text" class="rpi-input" placeholder="ID of role to give to verified RPI users" required>
            </div>

            <!-- <div class="rpi-field">
                <label for="new-client-nickname" class="rpi-label">Discord Nickname Style</label>
                <select id="new-client-nickname" name="is_rcs_id_in_nickname" class="rpi-select" required>
                    <option disabled>Frank M</option>
                    <option value="no">Frank M '22</option>
                    <option value="yes">Frank M '22 (matraf)</option>
                </select>
            </div> -->

            <div class="rpi-field">
                <label for="new-client-is-public" class="rpi-label">Public?</label>
                <input type="checkbox" name="is_public" id="new-client-is-public">
            </div>

            <button class="rpi-button" type="submit">Add Client</button>
        </form>
    </div>
</div>

{% endblock %}